import{r as v,c as f,h as l,g as w}from"./index-e2c2285b-c4441d08.js";import{c as M}from"./utils-9777d7c1-a2ad5c7b.js";function c(t="",e=""){const r=e.length>0?e.length:void 0;if(!t||!e)return{value:t,formattedValue:t,maxlength:r};const i=new Set(["@","9"]),a=new Set(["a","A","0",...i]),u=e.split("");let o=0;const g=new Set(u.filter(s=>!a.has(s))),d=u.reduce((s,n)=>{if(o>=t.length||i.has(n)&&g.has(t[o]))return s;if(a.has(n)){const h=p(n);return h?(o++,{value:`${s.value}${h}`,formattedValue:`${s.formattedValue}${h}`}):s}return t[o].includes(n)&&o++,{value:s.value,formattedValue:`${s.formattedValue}${n}`}},{value:"",formattedValue:""});return{value:d.value,formattedValue:d.formattedValue,maxlength:r};function p(s){if(o>=t.length)return"";let n=t[o];switch(s){case"a":n=n.replace(/[^a-zA-Z]+/g,"");break;case"A":n=n.replace(/[^A-Z]+/g,"");break;case"0":n=n.replace(/[^\d]/g,"");break;case"@":n=n.replace(/[^\da-zA-Z]+/g,"");break;case"9":n=n.replace(/[^\d]/g,"");break}return n||(o++,p(s))}}const b={"MM/DD/YYYY":"00/00/0000","M/D/YYYY":"09/09/0000","MM/DD/YY":"00/00/00","M/D/YY":"09/09/00","MM/YY":"00/00","M/YY":"09/00"};function E(t,e="MM/DD/YYYY"){const r=b[e]??b["MM/DD/YYYY"];return c(t,r)}function V(t="",e={decimals:0,delimited:!0},r=!1){const i=e?.decimals??0;let a=t;r&&(a=t.replace(/[^\d.]/g,""),a=a?Number(a).toFixed(i):""),a=a.replace(/[^\d]/g,"");const{integerString:u,decimalString:o}=O(a,i),g=e?.delimited?",":"",d=i>0?".":"",p=u.replace(/\B(?=(\d{3})+(?!\d))/g,g),s=`${d}${o}`,n=`${u}${s}`,h=`${p}${s}`;return{value:n,formattedValue:h,formattingCharacterCount:h.length-n.length+d.length}}function O(t,e){const r=t.length-e;let i=t.substring(0,r).padStart(e>0?1:0,"0");i.length>1&&i[0]==="0"&&(i=i.substring(1));const a=t.substring(r).padStart(e,"0");return{integerString:i,decimalString:a}}const m={delimited:{decimals:2,delimited:!0},dec:{decimals:0,delimited:!0},integer:{decimals:0,delimited:!1}};function C(t,e="delimited",r=!1){if(e.includes("dec")){const a=Number(e.replace("dec","")),u={...m.dec,decimals:a};return V(t,u,r)}const i=m[e]??m.delimited;return V(t,i,r)}const y={US:{format:"(000) 000-0000"}};function j(t,e="US"){const r=y[e]??y.US;return c(t,r.format)}const x={hex:"#@@@@@@",hexa:"#@@@@@@@@",rgb:"rgb(099, 099, 099)",rgba:"rgba(099, 099, 099, 0.09)"};function S(t,e="hex"){const r=x[e]??x.hex,i=c(t.toLowerCase(),r);return e.includes("rgb")?{...i,value:i.formattedValue}:i}const I=`*{box-sizing:border-box}input,button{font-family:inherit;font-size:inherit}button{cursor:pointer;background:none;border:none}:host(.sr),:host(.sr) button{border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;white-space:nowrap}.sr,.sr button{border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;white-space:nowrap}.hidden{display:none}:host([hidden]){display:none}.invisible{visibility:hidden}:host{display:block;margin:var(--protean-input-margin, 1rem)}.input-wrapper{position:relative;--input-container-horizontal-padding:calc(
        0.4375rem + (var(--protean-input-border-radius, 2px) / 2)
    )}.input-container{border:1px solid var(--protean-input-border-color);border-radius:var(--protean-input-border-radius, 2px);flex-grow:1;overflow:hidden}:host([disabled]) .input-container{opacity:var(--protean-input-disabled-opacity, 0.4)}:host([disabled]) .input-container,:host([disabled]) label,:host([disabled]) input{cursor:not-allowed}.input-container:focus-within{outline:auto 1px}.input-container.has-error{border-color:var(--protean-status-error, #ab0000)}.error-icon{margin-right:0.25rem;height:1.25em;width:1.25em}label{display:flex;align-items:center;font-weight:var(--protean-input-label-font-weight, 600);padding:0.375rem var(--input-container-horizontal-padding) 0.25rem;font-size:var(--protean-input-label-font-size, 0.75rem)}.optional-tag{font-size:var(--protean-input-label-optional-font-size, 0.75rem);font-weight:var(--protean-input-label-optional-font-weight, 500);margin-left:0.25rem}input{height:30px;width:100%;padding:0 var(--input-container-horizontal-padding);border:none;background-color:transparent;font-size:var(--protean-input-font-size, 1rem);color:inherit;box-shadow:none;text-align:left}input[type='color']{display:block;padding:0;min-width:55px;cursor:pointer}::-webkit-color-swatch-wrapper{padding:0}::-webkit-color-swatch{border:none}::-moz-color-swatch{border:none}:host(:not([label])) input{height:55px}input:focus{outline:none}.message-container{position:absolute;top:calc(100% - 1px);width:100%;height:0;transition:height 0.2s ease-in-out;overflow:hidden;z-index:2;box-shadow:0 2px 4px rgba(0, 0, 0, 0.5)}.message-container protean-message{margin:0}.message-container ul{margin:0;padding:0 1rem}`,Y=class{constructor(t){v(this,t),this.change=f(this,"change",3),this.input=f(this,"input",3),this.guid=M(),this.inputId=`protean-input-${this.guid}`,this.descriptionId=`protean-input-description-${this.guid}`,this.scheduledAfterRender=[],this.isFocused=!1,this.onInputChange=e=>{e.stopPropagation(),this.formattedValueObject=this.getFormattedValueObj(this.inputElement.value),this.inputElement.value=this.formattedValueObject.formattedValue,this.value!==this.formattedValueObject.value&&this.change.emit({value:this.formattedValueObject.value,formattedValue:this.formattedValueObject.formattedValue})},this.onInputInput=e=>{e.stopPropagation(),this.formattedValueObject=this.getFormattedValueObj(this.inputElement.value),this.cursorData=this.calculateCursorPositionOnInput(),this.inputElement.value=this.formattedValueObject.formattedValue,this.setCursorPosition(),this.value!==this.formattedValueObject.value&&this.input.emit({value:this.formattedValueObject.value,formattedValue:this.formattedValueObject.formattedValue})},this.onInputFocus=()=>{this.isFocused=!0,this.setMessagesHeight()},this.onInputBlur=()=>{this.isFocused=!1,this.showMessages&&(this.messageContainer.style.height="0px")},this.onLabelClick=e=>{e.stopImmediatePropagation()},this.value=void 0,this.type=void 0,this.label=void 0,this.disabled=!1,this.maxlength=void 0,this.format=void 0,this.optional=void 0,this.hints=void 0,this.errors=void 0,this.suppressMessages=void 0,this.readonly=!1,this.a11yLabel=void 0,this.ariaHasPopup=void 0,this.a11yExpanded=void 0,this.ariaRole=void 0,this.formattedValueObject=void 0}componentWillLoad(){this.formattedValueObject=this.getFormattedValueObj(this.value,!0)}componentDidLoad(){this.inputElement.value=this.formattedValueObject.formattedValue}componentDidRender(){this.scheduledAfterRender.forEach(t=>{t()}),this.scheduledAfterRender=[]}get inputElement(){return this.hostElement.shadowRoot.querySelector("input")}get computedType(){return this.type?.includes("formatted-")?"custom":this.type}get inputType(){const t=this.computedType==="custom"?this.type.split("formatted-")[1]:this.computedType;return{text:"text",tel:"tel",phone:"tel",numeric:"tel",date:"tel",password:"password",search:"search",button:"button",color:"color","color-code":"text"}[t]??"text"}get inputAriaLabel(){return this.label?null:this.a11yLabel??null}get inputAriaRequired(){return this.ariaHasPopup==="listbox"?null:`${!this.optional}`}get inputMaxlength(){const{maxlength:t,formattingCharacterCount:e}=this.formattedValueObject;if(t)return t;if(this.maxlength)return this.maxlength+(e??0)}get hasErrors(){return Array.isArray(this.errors)&&this.errors.length>0}get messages(){if(this.hasErrors)return this.errors;if(Array.isArray(this.hints)&&this.hints.length>0)return this.hints}get showMessages(){return Array.isArray(this.messages)&&this.messages.length>0&&!this.suppressMessages}get messageContainer(){return this.hostElement.shadowRoot.querySelector(".message-container")}get messageContainerHeight(){return`${this.hostElement.shadowRoot.querySelector(".message-container protean-message").getBoundingClientRect().height}px`}defaultChangeHandler(t){this.hostElement.onchange||(this.value=t.detail.value)}delegateFocus(t){t.target===this.hostElement&&this.inputElement.focus()}reformatValue(){this.formattedValueObject=this.getFormattedValueObj(this.value,!0),this.inputElement.value=this.formattedValueObject.formattedValue}onMessageUpdate(){this.isFocused&&this.scheduledAfterRender.push(()=>{this.setMessagesHeight()})}setMessagesHeight(){this.showMessages?this.messageContainer.style.height=this.messageContainerHeight:this.messageContainer.style.height="0px"}getFormattedValueObj(t="",e=!1){const i={phone:j,date:E,numeric:C,"color-code":S,custom:c}[this.computedType];return i?.(t,this.format,e)??{value:t,formattedValue:t}}calculateCursorPositionOnInput(){const t=this.inputElement,e=this.formattedValueObject.formattedValue.length;return{startingPosition:t.selectionStart??e,valueLength:e,previousValueLength:t.value.length,hasSelection:!1}}setCursorPosition(){if(this.type!=="color"&&!this.cursorData.hasSelection){const t=this.inputElement,{valueLength:e,previousValueLength:r,startingPosition:i}=this.cursorData,a=i+(e-r);t.setSelectionRange(a,a)}}render(){return l("div",{class:"input-wrapper"},l("div",{class:`input-container ${this.hasErrors?"has-error":""}`},this.label&&l("label",{htmlFor:this.inputId,onClick:this.onLabelClick},this.hasErrors&&l("protean-icon",{type:"status-error-filled",class:"error-icon"}),this.label,this.optional&&l("span",{class:"optional-tag"}," (optional)")),l("input",{id:this.inputId,type:this.inputType,disabled:this.disabled,readOnly:this.readonly,maxLength:this.inputMaxlength,role:this.ariaRole,"aria-required":this.inputAriaRequired,"aria-label":this.inputAriaLabel,"aria-invalid":`${this.hasErrors}`,"aria-describedby":this.descriptionId,"aria-haspopup":this.ariaHasPopup,"aria-expanded":this.a11yExpanded===void 0?null:`${this.a11yExpanded}`,onChange:this.onInputChange,onInput:this.onInputInput,onFocus:this.onInputFocus,onBlur:this.onInputBlur})),this.renderMessages())}renderMessages(){return l("div",{class:"message-container"},l("protean-message",{type:this.hasErrors?"error":"info",level:"status",variant:"inline"},l("ul",{id:this.descriptionId},this.showMessages&&this.messages.map(t=>l("li",null,t)))))}get hostElement(){return w(this)}static get watchers(){return{value:["reformatValue"],type:["reformatValue"],format:["reformatValue"],hints:["onMessageUpdate"],errors:["onMessageUpdate"]}}};Y.style=I;export{Y as protean_input};
